---
layout: blog
title: "MLOps"
subtitle: ""
date: 2025-01-21 18:03:43 +09:00
categories: study
author: "hoonably"
---
<div class="page-body"><h1 id="182451cf-7b79-808d-877c-cb8a9dafa31c" class="">MLOps (<strong>ë¨¸ì‹ ëŸ¬ë‹ ìš´ì˜)</strong></h1><figure id="182451cf-7b79-804c-bc1d-f01adc48f3ed" class="image" style="text-align:left"><a href="/files/2025-01-21-mlops/image.png"><img style="width:432px" src="/files/2025-01-21-mlops/image.png"/></a></figure><p id="182451cf-7b79-8085-a72f-c5926eea0b1c" class="">
</p><h3 id="182451cf-7b79-8037-a4d7-c241e6595315" class="">Design</h3><p id="182451cf-7b79-8073-8212-ff8511094a70" class="">ë¨¸ì‹ ëŸ¬ë‹ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ ì—¬ëŸ¬ êµ¬ì„±ìš”ì†Œ (configuration)</p><ul id="182451cf-7b79-80f3-b09d-c471f39e81c2" class="bulleted-list"><li style="list-style-type:disc">Dataset : ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ í•™ìŠµ ì‹œí‚¤ê¸° ìœ„í•œÂ ë°ì´í„°.</li></ul><ul id="182451cf-7b79-804e-bb60-c0c83057bef8" class="bulleted-list"><li style="list-style-type:disc">Metric : ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ì¸¡ì •ì„ ìœ„í•œÂ í‰ê°€ ì§€í‘œ.</li></ul><ul id="182451cf-7b79-8059-b153-fe5efd94c140" class="bulleted-list"><li style="list-style-type:disc">Model : í•´ê²°í•˜ê³ ì í•˜ëŠ” Taskì˜ ì¢…ë¥˜ì™€ Dataì˜ íŠ¹ì„±ì— ë§ëŠ”Â ì•Œê³ ë¦¬ì¦˜.</li></ul><ul id="182451cf-7b79-8084-8deb-dd3a935ab255" class="bulleted-list"><li style="list-style-type:disc">Hyper-parameter : ëª¨ë¸ë§ ì„±ëŠ¥ì„ ë†’ì´ê¸° ìœ„í•´ ì‚¬ìš©ìê°€Â ì§ì ‘ ì„¸íŒ…í•´ì£¼ëŠ” ê°’.</li></ul><p id="182451cf-7b79-8095-8b62-c9c1ad7046d6" class="">
</p><h3 id="182451cf-7b79-803e-89ad-c04cc5ebd0c7" class="">Model development</h3><p id="182451cf-7b79-80c4-bc09-db0a8f933988" class="">ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì–»ê¸° ìœ„í•´ì„œëŠ” ì—¬ëŸ¬ê°€ì§€ hyper-parameter ê°’ì„ ë³€ê²½í•˜ë©°Â ë‹¤ì–‘í•œ ì‹¤í—˜ì„ í•´ì•¼í•¨</p><p id="182451cf-7b79-8020-bfe8-ee1b7aa2d675" class="">â†’ ì—¬ëŸ¬ ì‹¤í—˜ ê²°ê³¼ë¥¼ ë¹„êµí•˜ê¸° ìœ„í•´Â ì •ë¦¬í•˜ëŠ” ê³¼ì •ì´ ë²ˆê±°ë¡œìš¸ ìˆ˜ ìˆìŒ</p><p id="182451cf-7b79-80ec-b2d5-c9cbd1d05d50" class="">
</p><p id="182451cf-7b79-8096-9396-f1f0117991e7" class="">
</p><h1 id="182451cf-7b79-805f-9f68-dbc3cfd36740" class="">WandB</h1><p id="182451cf-7b79-80d5-937d-d5bfc4bf14cf" class="">W and B (Weights &amp; Biases)</p><p id="182451cf-7b79-80e0-9220-df70be051bf5" class="">â†’ ë”¥ëŸ¬ë‹ ì‹¤í—˜ ê³¼ì •ì„ ì†ì‰½ê²Œ Trackingí•˜ê³ , ì‹œê°í™”í•  ìˆ˜ ìˆëŠ” Tool</p><ul id="182451cf-7b79-8076-85d1-f048fb26783c" class="bulleted-list"><li style="list-style-type:disc">hyperparameterë³„ ê²°ê³¼ ë¹„êµ</li></ul><ul id="182451cf-7b79-8063-beb0-f7a4114274fa" class="bulleted-list"><li style="list-style-type:disc">í•™ìŠµ ê³¼ì • visualization</li></ul><ul id="182451cf-7b79-805d-a2ea-c4582b15aa8e" class="bulleted-list"><li style="list-style-type:disc">system ëª¨ë‹ˆí„°ë§</li></ul><ul id="182451cf-7b79-80d7-bfa7-ca05978c28cb" class="bulleted-list"><li style="list-style-type:disc">í˜‘ì—…</li></ul><ul id="182451cf-7b79-8052-bd6e-f4be7a7e6f76" class="bulleted-list"><li style="list-style-type:disc">ê³¼ê±° ì‹¤í—˜ parameter ë³µì œ</li></ul><figure id="182451cf-7b79-804e-96f1-ca84223927b5" class="image"><a href="/files/2025-01-21-mlops/image%201.png"><img style="width:2494px" src="/files/2025-01-21-mlops/image%201.png"/></a></figure><p id="182451cf-7b79-809b-b1d4-ec6fbe619d43" class="">
</p><p id="182451cf-7b79-8096-82b3-ec1741d63783" class="">ìš°ì„  wandb íšŒì›ê°€ì… ì§„í–‰ (<a href="https://wandb.ai/site">https://wandb.ai/site</a>)</p><p id="182451cf-7b79-80e7-840d-e661764d79e5" class="">
</p><h2 id="182451cf-7b79-80c6-80d4-f8004b371e84" class="">wandb install</h2><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="182451cf-7b79-806d-80f7-da0768f1ba10" class="code"><code class="language-Bash">pip install wandb
pip3 install wandb  # pipê°€ ì—†ë‹¤ê³  ëœ¨ë©´ ì´ê±¸ë¡œ</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="182451cf-7b79-8084-869f-d978d80b25f6" class="code"><code class="language-Bash">wandb login</code></pre><p id="182451cf-7b79-808d-ba08-f818b2c5fa1a" class="">ê·¸ í›„ API Keyë¥¼ ì…ë ¥í•˜ë¼ê³  í•¨</p><p id="182451cf-7b79-8064-b700-d65b1b384a29" class="">â†’ Â <a href="https://wandb.ai/authorize">https://wandb.ai/authorize</a> ì—ì„œ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ìœ¼ë©´ ë¨</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="182451cf-7b79-8012-a557-c85c959b9903" class="code"><code class="language-Python"># ë‚´ API Key
e60e3a61bebeec0beccabf93a087ef2fd3e8786f</code></pre><figure id="182451cf-7b79-80e3-90ae-d6028ca5dc4d" class="image"><a href="/files/2025-01-21-mlops/image%202.png"><img style="width:707.984375px" src="/files/2025-01-21-mlops/image%202.png"/></a></figure><h1 id="182451cf-7b79-808e-b883-e96369d3acc4" class="">Test</h1><p id="8384f527-39f9-4ec2-9643-1ceaaf8ba0a0" class="">
</p><p id="6d451e77-eeee-45b6-9e33-6edaae3b8a90" class="">uailab-unist_ ì´ë¦„ì˜ íŒ€ì—ì„œ ë‚´ Projectë¥¼ ë§Œë“¤ì–´ë³´ê³  test í•´ë³´ê¸°</p><figure id="2be5c109-d970-4764-978c-fd6b11b52b2a" class="image"><a href="/files/2025-01-21-mlops/image%203.png"><img style="width:679.953125px" src="/files/2025-01-21-mlops/image%203.png"/></a></figure><p id="8e8ab64b-d31c-410e-9c47-7090571eba77" class="">Create new projectë¡œ ë‚´ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì–´ë³´ì.</p><figure id="c252f2c0-355b-470a-9226-db6bb877ec9c" class="image"><a href="/files/2025-01-21-mlops/image%204.png"><img style="width:2784px" src="/files/2025-01-21-mlops/image%204.png"/></a></figure><p id="fcb58fef-1dda-44bc-bab7-8066f80852c6" class="">
</p><p id="61f4e755-5e7e-4d1b-8864-d7a9aaa9f058" class="">ê·¸ëŸ¼ ìœ„ í™”ë©´ì²˜ëŸ¼ ì¹œì ˆí•˜ê²Œ ì²« ì‹œì‘ ë°©ë²•ì„ ì•Œë ¤ì¤€ë‹¤.</p><p id="ebc410e5-f1dd-4c2e-ba1b-f42df12feace" class="">ë¡œê·¸ì¸ì€ ì•„ê¹Œ í–ˆìœ¼ë‹ˆ, ë‹¤ìŒ ì½”ë“œë¥¼ ë°”íƒ•ìœ¼ë¡œ ì½”ë“œë¥¼ ì§œë³´ì.</p><p id="91d8dce4-6c30-4674-8334-3d2297b12258" class="">wandb.init ì´ ì¤‘ìš”í•˜ë¯€ë¡œ ë‹¤ë¥¸ ì˜µì…˜ë„ ì¶”ê°€í•´ë´¤ë‹¤.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b26bfe8a-d0a1-4efc-8e7b-8d8d313b9c33" class="code"><code class="language-Python">import wandb
import random

wandb.login()

# start a new wandb run to track this script
wandb.init(
    # í”„ë¡œì íŠ¸ ì´ë¦„
    project=&quot;tinyllm_hoon&quot;,

    # íŒ€ ë˜ëŠ” ì‚¬ìš©ì ì´ë¦„
    # ì´ê±° ì™œ ì•ˆë˜ëŠ”ê±°ì§€?
    # entity=&quot;hoonably&quot;,

    # ì‹¤í—˜ ì´ë¦„
    name=&quot;test1&quot;,

    # ì‹¤í–‰ì— ëŒ€í•œ ì„¤ëª…
    notes=&quot;trainging test&quot;,

    # ì‹¤í—˜ì„ ê·¸ë£¹í™”í•˜ëŠ” íƒœê·¸
    tags=[&quot;tag1&quot;, &quot;tag2&quot;],

    # offline modeë¡œ ì‹¤í–‰í•˜ë ¤ë©´ mode=&quot;offline&quot;ìœ¼ë¡œ ì„¤ì •
    # mode=&quot;online&quot;,

    # hyperparameter ì„¤ì •ê°’
    config={
    &quot;learning_rate&quot;: 0.02,
    &quot;architecture&quot;: &quot;CNN&quot;,
    &quot;dataset&quot;: &quot;CIFAR-100&quot;,
    &quot;epochs&quot;: 10,
    }
)

# simulate training
epochs = 10
offset = random.random() / 5
for epoch in range(2, epochs):
    acc = 1 - 2 ** -epoch - random.random() / epoch - offset
    loss = 2 ** -epoch + random.random() / epoch + offset

    # log metrics to wandb
    wandb.log({&quot;acc&quot;: acc, &quot;loss&quot;: loss})

# [optional] finish the wandb run, necessary in notebooks
wandb.finish()</code></pre><figure id="834d6bfd-7fcf-4bc4-af80-ff69268fc5a2" class="image"><a href="/files/2025-01-21-mlops/image%205.png"><img style="width:679.9921875px" src="/files/2025-01-21-mlops/image%205.png"/></a></figure><p id="1d6bb85d-d7fc-43b2-b170-87cfc1a9eb88" class="">ë‹¤ìŒê³¼ ê°™ì´ ì„±ê³µí•˜ë©´, wandb ë¼ëŠ” í´ë”ê°€ ê°™ì€ ë””ë ‰í† ë¦¬ì— ìƒì„±ë˜ë©° ë¡œê·¸ê°€ ë‚¨ëŠ”ë‹¤.</p><figure id="9499c173-ae3d-4897-9f64-41592591f138" class="image"><a href="/files/2025-01-21-mlops/image%206.png"><img style="width:679.9921875px" src="/files/2025-01-21-mlops/image%206.png"/></a></figure><p id="92718ed7-27a8-472c-baf3-094f3fb63c79" class="">ë˜í•œ ë™ì‹œì— wandb í˜ì´ì§€ì— ì˜¨ë¼ì¸ìœ¼ë¡œë„ ê²°ê³¼ê°€ ì „ì†¡ë˜ì–´ ì €ì¥ëœë‹¤.</p><figure id="0afb768b-3f4b-4e9f-9a25-b46dcdcfa75c" class="image"><a href="/files/2025-01-21-mlops/image%207.png"><img style="width:2558px" src="/files/2025-01-21-mlops/image%207.png"/></a></figure><figure id="1dece89d-e9b7-442b-964e-956d78844815" class="image"><a href="/files/2025-01-21-mlops/image%208.png"><img style="width:2526px" src="/files/2025-01-21-mlops/image%208.png"/></a></figure><p id="b67b7567-d84d-4b7a-a4a8-d7513fdf9972" class="">
</p><p id="182451cf-7b79-8080-8fc3-cc316ee85cc6" class="">
</p><p id="182451cf-7b79-80cd-976a-d54f9e03d761" class="">
</p><h2 id="182451cf-7b79-8027-b586-fa3742400f64" class="">ê²°ê³¼</h2><p id="182451cf-7b79-805b-aa2c-eab996e5451b" class="">ë‹¤ìŒê³¼ ê°™ì´ ì—¬ëŸ¬ ê²°ê³¼ë¥¼ ë¹„êµí•  ìˆ˜ ìˆë‹¤.</p><figure id="182451cf-7b79-8065-9be1-ccf0248e99ca" class="image"><a href="/files/2025-01-21-mlops/image%209.png"><img style="width:707.9921875px" src="/files/2025-01-21-mlops/image%209.png"/></a></figure><figure class="block-color-orange_background callout" style="white-space:pre-wrap;display:flex" id="182451cf-7b79-80dc-8496-ce95095790d2"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%"><p id="c34fba6b-2b90-4209-b094-5e9ed8cb2777" class="">ê° ë°ì´í„°ê°€ 10ê°œë§Œ ë³´ì´ëŠ”ë°, </p><p id="182451cf-7b79-8062-a43f-e0e853bd7ff7" class="">í†±ë‹ˆë°”í€´ ëˆ„ë¥´ê³  <strong>Max runs to show</strong>ë¥¼ ì˜¬ë ¤ì£¼ë©´ ë” ë§ì€ ë°ì´í„°ë¥¼ ê·¸ë˜í”„ë¡œ ë¹„êµí•  ìˆ˜ ìˆë‹¤.</p></div></figure><figure id="182451cf-7b79-8043-a528-d0fc99cec004" class="image" style="text-align:left"><a href="/files/2025-01-21-mlops/image%2010.png"><img style="width:528px" src="/files/2025-01-21-mlops/image%2010.png"/></a></figure><p id="191451cf-7b79-8001-90c0-eac244c5b050" class="">
</p><p id="191451cf-7b79-80ca-a74a-ff8223d71425" class="">
</p><h1 id="191451cf-7b79-805c-a296-c3b2c29d8e3d" class="">Tagì— ì •ë³´ë¥¼ ë„£ì</h1><p id="191451cf-7b79-8064-be6f-dd9445b0e06a" class="">ë‹¤ìŒê³¼ ê°™ì´ ì •ë³´ë¥¼ ë„£ìœ¼ë©´ Tagë¥¼ ëˆŒëŸ¬ ë¹„êµí•˜ê¸° ì¢‹ë‹¤.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="191451cf-7b79-80d2-b8f3-ce1b865dd2f3" class="code"><code class="language-Bash"># Device ì„¤ì •
device = &#x27;cuda&#x27; if torch.cuda.is_available() else &#x27;cpu&#x27;

# GPU ëª¨ë¸ëª… í™•ì¸
gpu_name = torch.cuda.get_device_name(0)

...

    run = wandb.init(
        project=&quot;TinyLLM&quot;,
        name=f&quot;{model_name} in {dataset_name}&quot;,
        notes=&quot;&quot;,
        tags=[gpu_name, model_name, dataset_name],
        mode=&quot;online&quot;
    )</code></pre><p id="191451cf-7b79-80fc-b923-f64a0a7985a3" class="">
</p></div>